category: secrets_management
checks:
  - id: sm001
    slug: plaintext_secrets_in_config
    title: "Plaintext Secrets in Configuration"
    severity: critical
    description: >
      Detects MCP server configuration files that contain secrets such as
      API keys, database passwords, encryption keys, and OAuth tokens
      stored in plaintext without encryption. Plaintext secrets in
      configuration files are the most common credential exposure vector.
    risk_explanation: >
      Plaintext secrets in configuration files are exposed to anyone with
      read access to the file system, including other processes on the
      same host, backup systems, configuration management tools, and log
      aggregators that capture configuration data. A single file read
      vulnerability or misconfigured file permissions exposes all secrets
      in the configuration, often granting access to databases, external
      APIs, and other critical services.
    remediation: >
      Move all secrets out of configuration files and into a dedicated
      secrets management service such as HashiCorp Vault, AWS Secrets
      Manager, or Azure Key Vault. Use encrypted configuration values
      with runtime decryption as an intermediate step. Implement
      configuration scanning in CI/CD pipelines that blocks deployments
      containing plaintext secrets. Rotate any secrets that were
      previously stored in plaintext.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm002
    slug: missing_secret_rotation
    title: "Missing Secret Rotation"
    severity: high
    description: >
      Detects MCP servers that use long-lived secrets without a rotation
      policy or mechanism. Secrets that are never rotated remain valid
      indefinitely, extending the window of opportunity for compromised
      credentials to be exploited.
    risk_explanation: >
      Without secret rotation, a compromised credential remains valid
      until manually revoked, which may never happen if the compromise
      goes undetected. Long-lived secrets accumulate exposure through
      backup systems, log files, memory dumps, and personnel changes.
      The longer a secret exists, the more opportunities arise for it
      to be exposed through any of these channels.
    remediation: >
      Implement automated secret rotation with configurable rotation
      periods based on secret sensitivity. Use short-lived tokens and
      certificates that expire automatically. Set up rotation schedules
      that align with compliance requirements. Implement zero-downtime
      rotation that supports overlapping validity periods during
      transitions. Monitor for secrets that exceed their rotation deadline.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm003
    slug: secrets_in_version_control
    title: "Secrets in Version Control"
    severity: critical
    description: >
      Detects MCP server repositories that contain secrets committed to
      version control history. Even if secrets are removed from current
      files, they persist in the git history and can be extracted by
      anyone with repository access.
    risk_explanation: >
      Secrets committed to version control are permanently recorded in
      the repository history and are accessible to all current and future
      repository users. Even after secrets are removed from the working
      tree, they remain in commit history indefinitely. Repositories
      cloned, forked, or backed up carry the secrets with them. Public
      repositories expose secrets to the entire internet.
    remediation: >
      Implement pre-commit hooks that scan for secrets and block commits
      containing them. Use tools such as git-secrets, trufflehog, or
      gitleaks in CI/CD pipelines. Remove any secrets currently in the
      repository history using git filter-branch or BFG Repo Cleaner, and
      rotate all affected secrets immediately. Add comprehensive patterns
      to .gitignore for files that may contain secrets.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm004
    slug: missing_vault_integration
    title: "Missing Vault Integration"
    severity: medium
    description: >
      Detects MCP servers that manage secrets directly rather than using
      a dedicated secrets management service or vault. Direct secret
      management lacks the encryption, access control, audit logging,
      and rotation capabilities that purpose-built vault systems provide.
    risk_explanation: >
      Without a secrets vault, the MCP server must handle encryption,
      access control, audit logging, and rotation of secrets using ad-hoc
      implementations that are typically less secure than purpose-built
      solutions. Custom secret management is prone to implementation
      errors such as weak encryption, missing access controls, and
      incomplete audit trails that leave secrets vulnerable to exposure.
    remediation: >
      Integrate the MCP server with a secrets management service such as
      HashiCorp Vault, AWS Secrets Manager, Azure Key Vault, or Google
      Secret Manager. Configure the server to retrieve secrets at runtime
      from the vault rather than storing them locally. Use vault-native
      features for encryption, access control, audit logging, and
      automatic rotation.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm005
    slug: hardcoded_encryption_keys
    title: "Hardcoded Encryption Keys"
    severity: critical
    description: >
      Detects MCP server source code or configuration that contains
      hardcoded encryption keys, initialization vectors, or salt values.
      Hardcoded cryptographic material makes encryption effectively
      useless as the keys are available to anyone with code access.
    risk_explanation: >
      Hardcoded encryption keys mean that every deployment uses the same
      cryptographic material. Anyone with access to the source code,
      compiled binary, or a decompiled version can decrypt all data
      encrypted by any instance of the server. This defeats the purpose
      of encryption entirely and exposes all encrypted data across all
      deployments simultaneously.
    remediation: >
      Generate unique encryption keys per deployment using a
      cryptographically secure random number generator. Store encryption
      keys in a hardware security module or secrets management service.
      Use key derivation functions to generate per-purpose keys from
      master keys. Implement key management that supports rotation
      without re-encrypting all data. Remove all hardcoded keys from
      source code and configuration.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm006
    slug: shared_secrets_across_environments
    title: "Shared Secrets Across Environments"
    severity: high
    description: >
      Detects MCP server deployments that use the same secrets across
      multiple environments such as development, staging, and production.
      Shared secrets mean that a compromise in a less-secure environment
      directly compromises production.
    risk_explanation: >
      When secrets are shared across environments, the security of
      production is only as strong as the weakest environment. Development
      environments typically have relaxed security controls, more people
      with access, and less monitoring. A secret compromised in
      development immediately grants production access. Staging
      environments that mirror production with the same secrets create
      an unmonitored backdoor to production data.
    remediation: >
      Generate unique secrets for each environment. Never copy secrets
      between environments. Implement environment-specific secret stores
      with separate access controls. Use naming conventions that make
      environment-specific secrets distinguishable. Automate secret
      provisioning per environment during deployment. Audit for shared
      secrets across environments regularly.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm007
    slug: missing_secret_audit
    title: "Missing Secret Access Audit"
    severity: medium
    description: >
      Detects MCP servers that do not log or audit access to secrets.
      Without secret access auditing, it is impossible to determine who
      accessed which secrets, when access occurred, or whether access
      was authorized after a security incident.
    risk_explanation: >
      Missing secret access auditing prevents detection of unauthorized
      secret access and makes incident investigation impossible. If a
      secret is compromised, the lack of audit logs means the breach
      timeline, scope, and impact cannot be determined. This also fails
      compliance requirements that mandate auditable access to
      cryptographic material and credentials.
    remediation: >
      Implement comprehensive audit logging for all secret access
      operations including reads, writes, rotations, and deletions. Log
      the accessor identity, timestamp, secret identifier, operation
      type, and access context. Store audit logs in tamper-proof storage
      separate from the secrets themselves. Set up alerts for anomalous
      secret access patterns such as bulk reads or access from unexpected
      sources.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm008
    slug: insecure_secret_generation
    title: "Insecure Secret Generation"
    severity: high
    description: >
      Detects MCP servers that generate secrets using weak random number
      generators, predictable algorithms, or insufficient entropy sources.
      Weakly generated secrets can be predicted or brute-forced by
      attackers who understand the generation algorithm.
    risk_explanation: >
      Secrets generated with insufficient entropy or predictable algorithms
      can be reproduced by an attacker. Standard random number generators
      such as Math.random() or time-based seeds produce predictable
      sequences that can be computed. Short secrets generated with weak
      randomness can be brute-forced in minutes. An attacker who determines
      the secret generation algorithm can predict past and future secrets.
    remediation: >
      Use cryptographically secure random number generators for all secret
      generation, such as os.urandom in Python, crypto.randomBytes in
      Node.js, or /dev/urandom on Linux. Generate secrets with sufficient
      length and entropy, a minimum of 256 bits for cryptographic keys and
      128 bits for tokens. Validate that the entropy source is properly
      seeded. Use well-tested secret generation libraries rather than
      custom implementations.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm009
    slug: secrets_in_environment_variables
    title: "Secrets in Environment Variables"
    severity: medium
    description: >
      Detects MCP servers that rely solely on environment variables for
      secret storage without additional protection. While better than
      hardcoding, environment variables are accessible to all processes
      running as the same user and are often logged or exposed through
      process listings and debug endpoints.
    risk_explanation: >
      Environment variables containing secrets are visible through
      /proc/self/environ on Linux, process inspection tools, debug
      endpoints, crash dumps, and child process inheritance. Any tool
      or library running in the same process has full access to all
      environment variables. Container orchestration platforms often
      log environment variables during deployment, and error reporting
      services may capture them in crash reports.
    remediation: >
      Use a secrets management service instead of environment variables
      for sensitive credentials. If environment variables must be used,
      minimize exposure by reading secrets at startup and clearing the
      environment variables. Prevent child process inheritance of secret
      environment variables. Ensure error reporting and logging exclude
      environment variable contents. Consider file-based secret injection
      as a more secure alternative.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm010
    slug: missing_secret_encryption
    title: "Missing Secret Encryption at Rest"
    severity: high
    description: >
      Detects MCP servers that store secrets without encrypting them at
      rest. Unencrypted secret storage means that physical access to the
      storage medium, database dumps, or backup files directly exposes
      all stored secrets in plaintext.
    risk_explanation: >
      Secrets stored without encryption at rest are exposed through any
      mechanism that provides access to the raw storage. This includes
      database dumps, file system backups, disk imaging, stolen hardware,
      and compromised storage services. Without encryption at rest, the
      confidentiality of secrets depends entirely on access controls to
      the storage layer, which may be bypassed through physical access
      or infrastructure compromise.
    remediation: >
      Encrypt all secrets at rest using strong encryption algorithms such
      as AES-256-GCM. Use envelope encryption where data encryption keys
      are themselves encrypted by key encryption keys stored separately.
      Implement proper key management for the encryption keys with
      hardware security module backing where possible. Verify encryption
      through regular audits that confirm no plaintext secrets exist in
      storage.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm011
    slug: secret_sprawl
    title: "Secret Sprawl"
    severity: medium
    description: >
      Detects MCP server deployments where the same secret is duplicated
      across multiple locations such as configuration files, environment
      variables, scripts, and documentation. Secret sprawl makes it
      impossible to effectively rotate or revoke secrets because copies
      persist in unknown locations.
    risk_explanation: >
      Secret sprawl means that rotating or revoking a secret does not
      actually remove all copies. Duplicated secrets in backup files,
      deployment scripts, documentation, and multiple configuration
      locations persist long after the primary copy is rotated. Each copy
      is an additional exposure point that can be independently
      discovered and exploited. The organization loses track of where
      secrets exist, making comprehensive rotation impossible.
    remediation: >
      Centralize all secrets in a single secrets management service with
      references from consuming systems rather than copies. Implement
      secret scanning across the entire codebase, configuration, and
      documentation to identify all copies. Eliminate duplicate copies by
      replacing them with references to the central store. Monitor for
      new secret copies being created outside the central store.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm012
    slug: missing_secret_revocation
    title: "Missing Secret Revocation"
    severity: high
    description: >
      Detects MCP servers that lack the ability to immediately revoke
      secrets when they are compromised. Without revocation capability,
      compromised secrets remain valid until they expire naturally, which
      may be never for long-lived credentials.
    risk_explanation: >
      When a secret compromise is detected, the ability to immediately
      revoke the secret is critical to limiting damage. Without
      revocation, the compromised secret continues to grant access while
      the incident is being investigated and resolved. For secrets without
      expiration, the compromised credential may be used indefinitely.
      Each minute of continued validity after detection extends the
      window for data exfiltration and lateral movement.
    remediation: >
      Implement immediate secret revocation for all credential types.
      Maintain a revocation list that is checked on every authentication
      attempt. Use short-lived tokens that require frequent renewal,
      limiting the impact window of compromise. Integrate revocation
      with incident response workflows for automated response. Test
      revocation procedures regularly to ensure they work under pressure.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm013
    slug: default_secrets_in_use
    title: "Default Secrets in Use"
    severity: critical
    description: >
      Detects MCP servers that are using default secrets, example tokens,
      or placeholder credentials that were included in documentation,
      sample configurations, or initial setup scripts. Default secrets
      are publicly known and provide trivial unauthorized access.
    risk_explanation: >
      Default secrets are documented in installation guides, source code
      repositories, and tutorial materials that are publicly accessible.
      Automated scanning tools continuously probe for servers using known
      default credentials. An MCP server using default secrets can be
      compromised within seconds of being exposed to the internet, as
      no vulnerability discovery is required. This is one of the most
      common and easily prevented causes of server compromise.
    remediation: >
      Replace all default secrets during initial server setup before
      accepting any client connections. Implement first-run checks that
      detect default secrets and refuse to start. Generate unique random
      secrets during installation. Scan running deployments for known
      default values. Remove example credentials from documentation and
      replace them with generation instructions.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm014
    slug: secrets_in_logs
    title: "Secrets in Log Output"
    severity: high
    description: >
      Detects MCP servers that include secrets in log output, whether in
      application logs, access logs, error logs, or debug logs. Logged
      secrets are exposed to anyone with log access and persist in log
      storage systems indefinitely.
    risk_explanation: >
      Secrets in logs are exposed to log aggregation systems, SIEM
      platforms, monitoring dashboards, and anyone with log file access.
      Logs are often retained for extended periods and stored with less
      security than credential stores. Log data may be shipped to
      third-party services, shared during debugging, or included in
      support requests. A secret logged once persists across all log
      backups and replicas.
    remediation: >
      Implement log sanitization that detects and masks secrets before
      they are written to log output. Use structured logging with
      explicit field marking for sensitive values. Never log
      authentication tokens, API keys, passwords, or encryption keys.
      Audit existing logs for secret exposure and purge any discovered
      instances. Implement automated log scanning for secret patterns.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials

  - id: sm015
    slug: missing_secret_access_control
    title: "Missing Secret Access Control"
    severity: high
    description: >
      Detects MCP servers where secrets are accessible to all server
      components, tools, and processes without granular access controls.
      Missing access control on secrets means that any tool or code
      running within the server can access all secrets regardless of
      whether it needs them.
    risk_explanation: >
      Without secret access controls, a vulnerability in any single tool
      or component exposes all server secrets. The principle of least
      privilege requires that each component only has access to the
      secrets it needs. When all secrets are accessible to all components,
      a compromised tool handler that only needs one API key can access
      database credentials, encryption keys, and all other secrets,
      maximizing the blast radius of any compromise.
    remediation: >
      Implement granular access controls on the secret store that restrict
      each tool and component to only the secrets it requires. Use
      separate service accounts or access policies per tool. Audit secret
      access patterns to identify and remove unnecessary access grants.
      Implement secret access request workflows for new components.
      Monitor for anomalous secret access patterns that may indicate
      compromise.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - secrets_management
      - credentials
