category: credential_exposure
checks:
  - id: cred004
    slug: gcp_service_account_key
    title: "GCP Service Account Key Exposure"
    severity: critical
    description: >
      Detects Google Cloud Platform service account JSON key files in MCP
      server configuration or environment. GCP service account keys contain
      private keys that grant full access to the associated cloud project
      resources and APIs.
    risk_explanation: >
      GCP service account JSON keys provide persistent, non-expiring access
      to cloud resources. A leaked key grants the attacker the full permissions
      of the service account, which often includes access to Cloud Storage,
      BigQuery, Compute Engine, and other services. Unlike short-lived tokens,
      service account keys remain valid until explicitly revoked.
    remediation: >
      Use Workload Identity Federation or attached service accounts instead of
      JSON key files. If keys are required, store them in a secrets manager
      and reference them via environment variables. Rotate keys regularly and
      set up key expiration. Monitor for key usage anomalies. Delete unused
      service account keys.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
      - "https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - gcp
      - service_account
      - cloud_credentials

  - id: cred005
    slug: azure_credentials
    title: "Azure Credential Exposure"
    severity: critical
    description: >
      Detects Azure client secrets, certificate thumbprints, or managed
      identity credentials in MCP server configuration. Azure credentials
      in configuration files grant access to Azure Active Directory, storage
      accounts, databases, and other cloud services.
    risk_explanation: >
      Exposed Azure credentials grant access to all resources the associated
      service principal or managed identity can access. This typically includes
      Azure AD operations, storage accounts, Key Vault secrets, and database
      connections. Client secrets in configuration are equivalent to a master
      key for the Azure tenant.
    remediation: >
      Use Azure Managed Identity for authentication instead of client secrets.
      Store necessary credentials in Azure Key Vault and reference them via
      environment variables. Implement credential rotation policies. Remove
      any Azure credentials from configuration files and version control
      history.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
      - "https://learn.microsoft.com/en-us/azure/active-directory/develop/security-best-practices-for-app-registration"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - azure
      - client_secret
      - cloud_credentials

  - id: cred006
    slug: database_connection_string
    title: "Database Connection String Exposure"
    severity: critical
    description: >
      Detects database connection strings with embedded credentials in MCP
      server configuration. Connection strings containing username:password
      in URLs (e.g. postgresql://user:pass@host/db) expose database
      credentials in plaintext.
    risk_explanation: >
      Database connection strings with embedded credentials grant direct
      database access. An attacker obtaining the connection string can connect
      to the database, read sensitive data, modify records, or drop tables.
      Connection strings in configuration files are often committed to version
      control and appear in logs, multiplying exposure vectors.
    remediation: >
      Remove credentials from database connection strings. Use environment
      variables for database credentials and reference them in connection
      configuration. Implement database credential rotation through secrets
      managers. Use certificate-based or IAM-based database authentication
      where available.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
      - "https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - database
      - connection_string
      - embedded_credentials

  - id: cred007
    slug: ssh_private_key
    title: "SSH Private Key Exposure"
    severity: critical
    description: >
      Detects SSH private keys in MCP server environment variables or
      configuration files. SSH private keys provide direct server access
      and are frequently used for deployment, git operations, and remote
      server management.
    risk_explanation: >
      An exposed SSH private key grants the attacker direct shell access to
      any server that trusts the corresponding public key. SSH access
      typically provides full system-level privileges. Private keys embedded
      in configuration are often shared across team members and environments,
      making the compromise scope extremely broad.
    remediation: >
      Never embed SSH private keys in configuration files or environment
      variables. Use SSH agent forwarding or deploy keys with minimal
      permissions. Store SSH keys with passphrase protection in secure
      locations. Use short-lived SSH certificates instead of static keys
      where possible. Rotate SSH keys regularly.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - ssh
      - private_key
      - server_access

  - id: cred008
    slug: jwt_secret_in_env
    title: "JWT Secret in Environment"
    severity: high
    description: >
      Detects JWT signing secrets stored in environment variables or
      configuration files. The JWT secret is the root of trust for token
      verification; its exposure allows an attacker to forge arbitrary
      valid tokens.
    risk_explanation: >
      The JWT signing secret enables creation of tokens with any claims,
      including admin roles and any user identity. An attacker who obtains
      the secret can bypass all authentication and authorization by forging
      tokens. The compromise is silent because forged tokens are
      indistinguishable from legitimate ones.
    remediation: >
      Store JWT secrets in dedicated secrets managers (HashiCorp Vault, AWS
      Secrets Manager). Use asymmetric signing algorithms (RS256, ES256) where
      only the public key needs to be distributed. Rotate signing secrets
      regularly with overlap periods for token migration. Never commit JWT
      secrets to version control.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - jwt
      - signing_secret
      - token_forgery

  - id: cred009
    slug: oauth_client_secret
    title: "OAuth Client Secret Exposure"
    severity: high
    description: >
      Detects OAuth client secrets in MCP server configuration files. OAuth
      client secrets authenticate the application to the authorization server
      and should never be exposed in client-side or plaintext configuration.
    risk_explanation: >
      An exposed OAuth client secret allows an attacker to impersonate the
      legitimate application to the authorization server. The attacker can
      exchange authorization codes for access tokens, request new tokens, and
      perform all API operations as the legitimate application. This
      compromises all users who have authorized the application.
    remediation: >
      Store OAuth client secrets in secrets managers. Use environment variable
      references in configuration files. For public clients (SPAs, mobile
      apps), use PKCE without client secrets. Rotate client secrets regularly
      and monitor for unauthorized token issuance. Never include client
      secrets in client-side code or public repositories.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - oauth
      - client_secret
      - authorization

  - id: cred010
    slug: smtp_credentials
    title: "SMTP Credential Exposure"
    severity: high
    description: >
      Detects email server credentials (SMTP username, password, API keys)
      in MCP server configuration. SMTP credentials allow sending emails as
      the configured sender, enabling phishing and spam campaigns through
      the organization's mail infrastructure.
    risk_explanation: >
      Exposed SMTP credentials allow an attacker to send emails through the
      organization's mail servers, bypassing SPF, DKIM, and DMARC
      protections. The attacker can send phishing emails that appear to
      originate from the organization's domain, damaging reputation and
      enabling social engineering attacks against employees and customers.
    remediation: >
      Store SMTP credentials in a secrets manager. Use environment variable
      references in configuration. Implement IP-based restrictions on SMTP
      authentication. Use dedicated service accounts with minimal permissions
      for transactional email. Monitor SMTP sending patterns for anomalies.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - smtp
      - email
      - mail_credentials

  - id: cred011
    slug: docker_registry_auth
    title: "Docker Registry Auth Exposure"
    severity: high
    description: >
      Detects Docker registry authentication credentials in MCP server
      configuration. Docker registry auth tokens stored in config.json or
      environment variables grant access to pull and push container images.
    risk_explanation: >
      Exposed Docker registry credentials allow an attacker to pull private
      container images containing proprietary code, push malicious images
      that will be deployed in production, or tamper with existing images.
      Registry access often includes images containing additional embedded
      secrets and configuration data.
    remediation: >
      Use credential helpers for Docker registry authentication instead of
      storing credentials in config.json. Implement short-lived token-based
      authentication for CI/CD pipelines. Use cloud-native registry
      authentication (ECR, GCR, ACR) with IAM roles. Remove registry
      credentials from configuration files.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - docker
      - registry
      - container_security

  - id: cred012
    slug: kubernetes_secrets
    title: "Kubernetes Secret Exposure"
    severity: critical
    description: >
      Detects Kubernetes secrets, service account tokens, or kubeconfig
      credentials in MCP server configuration. Kubernetes credentials grant
      access to cluster resources, pods, and potentially the underlying
      infrastructure.
    risk_explanation: >
      Kubernetes service account tokens and kubeconfig credentials grant
      cluster access with the permissions of the associated role. An attacker
      can use these credentials to deploy malicious containers, access secrets
      stored in the cluster, escalate privileges through RBAC misconfigurations,
      or pivot to the underlying node infrastructure.
    remediation: >
      Never embed Kubernetes credentials in MCP configuration. Use service
      account token mounting with minimal RBAC permissions. Implement
      short-lived token authentication via TokenRequest API. Store kubeconfig
      files securely with restrictive file permissions. Use workload identity
      for cross-service authentication.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - kubernetes
      - service_account
      - cluster_access

  - id: cred013
    slug: terraform_state_secrets
    title: "Terraform State Secrets"
    severity: critical
    description: >
      Detects secrets leaked through Terraform state files referenced in
      MCP server configuration. Terraform state files contain plaintext
      values of all managed resources, including database passwords, API
      keys, and private keys.
    risk_explanation: >
      Terraform state files store the complete state of managed
      infrastructure in plaintext JSON, including all resource attributes.
      Database passwords, encryption keys, and API tokens in state files
      are stored unencrypted. Access to a state file grants visibility
      into the entire infrastructure, including credential values that
      were intended to be secret.
    remediation: >
      Store Terraform state in encrypted remote backends (S3 with encryption,
      Terraform Cloud). Enable state encryption at rest. Use sensitive
      variables and mark outputs as sensitive. Restrict state file access
      using IAM policies. Never reference Terraform state files directly
      in MCP configuration.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - terraform
      - state_file
      - infrastructure_secrets

  - id: cred014
    slug: npm_token_exposure
    title: "NPM Token Exposure"
    severity: high
    description: >
      Detects NPM authentication tokens in .npmrc files, environment
      variables, or MCP server configuration. NPM tokens grant permissions
      to publish, modify, and manage packages in the npm registry.
    risk_explanation: >
      An exposed NPM token allows an attacker to publish malicious versions
      of packages owned by the token holder. This enables supply chain
      attacks where downstream consumers automatically install compromised
      packages. The attacker can also access private packages, modify package
      metadata, and delete published versions.
    remediation: >
      Use npm token list to audit existing tokens. Revoke and rotate any
      exposed tokens immediately. Use granular automation tokens with
      minimal scopes for CI/CD. Store tokens in CI/CD secrets management,
      not in .npmrc files. Enable two-factor authentication on npm accounts.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - npm
      - package_registry
      - supply_chain

  - id: cred015
    slug: pypi_token_exposure
    title: "PyPI Token Exposure"
    severity: high
    description: >
      Detects PyPI API tokens in configuration files, .pypirc, or
      environment variables. PyPI tokens grant permissions to upload Python
      packages to the Python Package Index.
    risk_explanation: >
      Exposed PyPI tokens allow an attacker to upload malicious versions of
      Python packages. This is a direct supply chain attack vector, as
      downstream users who install the package receive the compromised code.
      PyPI tokens typically have project-scoped or account-wide upload
      permissions.
    remediation: >
      Use scoped API tokens instead of account-wide tokens for PyPI uploads.
      Store tokens in CI/CD secrets management. Rotate tokens after any
      potential exposure. Enable two-factor authentication on PyPI accounts.
      Use trusted publishers (OIDC-based publishing) for CI/CD pipelines.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - pypi
      - package_registry
      - supply_chain

  - id: cred016
    slug: encryption_key_exposure
    title: "Encryption Key Exposure"
    severity: critical
    description: >
      Detects symmetric or asymmetric encryption keys in MCP server
      configuration. Exposed encryption keys compromise the confidentiality
      of all data encrypted with those keys, including stored data and
      communications.
    risk_explanation: >
      An exposed encryption key allows an attacker to decrypt all data
      protected by that key. For symmetric keys (AES, ChaCha20), this
      includes both encrypting new data and decrypting existing data. For
      asymmetric private keys, the attacker can decrypt communications and
      forge signatures. Historical encrypted data becomes retroactively
      compromised.
    remediation: >
      Store encryption keys in hardware security modules (HSMs) or key
      management services (AWS KMS, Azure Key Vault, GCP Cloud KMS). Never
      embed encryption keys in configuration files. Implement key rotation
      with re-encryption of stored data. Use envelope encryption where the
      data encryption key is itself encrypted by a master key.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - encryption_key
      - cryptography
      - key_management

  - id: cred017
    slug: webhook_secret_exposure
    title: "Webhook Secret Exposure"
    severity: high
    description: >
      Detects webhook signing secrets in MCP server configuration. Webhook
      secrets are used to verify that incoming webhook requests originate
      from the expected source. Exposed secrets allow attackers to forge
      webhook payloads.
    risk_explanation: >
      Webhook signing secrets validate the authenticity of incoming
      requests. An attacker who knows the secret can forge webhook payloads
      that pass signature verification, triggering arbitrary actions on the
      receiving server. This can include deployment triggers, notification
      systems, and automated workflows that trust webhook-delivered data.
    remediation: >
      Store webhook secrets in secrets managers and reference them via
      environment variables. Rotate webhook secrets regularly. Implement
      additional validation beyond HMAC signature (IP allowlisting,
      timestamp checks). Monitor for unexpected webhook patterns that
      might indicate secret compromise.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - webhook
      - signing_secret
      - payload_forgery

  - id: cred018
    slug: ldap_bind_credentials
    title: "LDAP Bind Credential Exposure"
    severity: high
    description: >
      Detects LDAP bind DN (Distinguished Name) and password in MCP server
      configuration. LDAP bind credentials authenticate the application to
      the directory server, often with broad read access to the entire
      directory tree.
    risk_explanation: >
      Exposed LDAP bind credentials grant directory read access, enabling
      enumeration of all users, groups, organizational units, and their
      attributes. In Active Directory environments, this includes password
      hashes, email addresses, phone numbers, and group memberships. Write
      access allows modifying directory entries and group memberships.
    remediation: >
      Store LDAP bind credentials in a secrets manager. Use service accounts
      with minimal required permissions (read-only, limited base DN). Implement
      LDAP connection pooling to minimize credential exposure. Use SASL/
      Kerberos authentication instead of simple bind where possible.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - ldap
      - bind_credentials
      - directory_access

  - id: cred019
    slug: redis_auth_exposure
    title: "Redis Auth Exposure"
    severity: high
    description: >
      Detects Redis AUTH passwords in connection strings or MCP server
      configuration. Redis credentials in configuration files grant access
      to cached data, session stores, and potentially the entire key-value
      store.
    risk_explanation: >
      Exposed Redis credentials grant access to all data stored in the Redis
      instance, which frequently includes session tokens, cached credentials,
      rate limiting state, and application data. Redis commands like CONFIG
      and DEBUG can be used for further exploitation, including writing files
      to the server filesystem.
    remediation: >
      Store Redis passwords in secrets managers. Use ACL-based authentication
      with minimal permissions. Enable TLS for Redis connections. Restrict
      dangerous Redis commands (CONFIG, DEBUG, EVAL) using ACL rules.
      Implement network-level access controls to limit Redis connectivity.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - redis
      - cache
      - connection_string

  - id: cred020
    slug: firebase_credentials
    title: "Firebase Credential Exposure"
    severity: high
    description: >
      Detects Firebase API keys, service account data, or admin SDK
      credentials in MCP server configuration. Firebase credentials provide
      access to Firestore, Realtime Database, Authentication, and Cloud
      Storage services.
    risk_explanation: >
      Firebase admin credentials bypass all security rules, granting
      unrestricted access to read, write, and delete data in Firestore and
      Realtime Database. Exposed admin SDK credentials can modify
      authentication records, impersonate users, and access all stored files.
      Even client API keys, while less dangerous, can be abused for quota
      exhaustion and data enumeration.
    remediation: >
      Use Firebase Admin SDK with application default credentials instead of
      explicit key files. Store Firebase credentials in environment variables
      or secrets managers. Implement proper Firebase Security Rules as a
      defense-in-depth measure. Restrict API key usage to specific domains
      and APIs.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - firebase
      - google_cloud
      - api_key

  - id: cred021
    slug: twilio_credentials
    title: "Twilio Credential Exposure"
    severity: high
    description: >
      Detects Twilio account SID and auth tokens in MCP server configuration.
      Twilio credentials grant access to send SMS messages, make phone calls,
      and access communication logs through the Twilio API.
    risk_explanation: >
      Exposed Twilio credentials allow an attacker to send SMS and make
      phone calls at the account holder's expense. This can be used for
      SMS phishing (smishing), spam campaigns, and social engineering.
      Access to communication logs reveals phone numbers, message content,
      and call recordings. Financial impact from fraudulent API usage can be
      substantial.
    remediation: >
      Store Twilio credentials in secrets managers. Use API key authentication
      instead of account SID and auth token. Implement usage alerts and
      spending limits. Restrict Twilio API keys to specific capabilities.
      Rotate credentials after any potential exposure.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - twilio
      - sms
      - communication_api

  - id: cred022
    slug: sendgrid_api_key
    title: "SendGrid API Key Exposure"
    severity: high
    description: >
      Detects SendGrid API keys in MCP server configuration or environment.
      SendGrid API keys grant permissions to send emails, manage contacts,
      and access email analytics through the SendGrid platform.
    risk_explanation: >
      Exposed SendGrid API keys allow an attacker to send emails through
      the organization's SendGrid account, bypassing email authentication
      (SPF, DKIM). The attacker can send phishing emails that appear to
      originate from the organization's verified domains. Access to contact
      lists exposes customer email addresses and metadata.
    remediation: >
      Store SendGrid API keys in secrets managers. Use scoped API keys with
      minimal permissions (e.g. mail send only). Implement IP access
      management to restrict API key usage to known IP ranges. Monitor
      sending patterns for anomalies. Rotate API keys regularly.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - sendgrid
      - email
      - api_key

  - id: cred023
    slug: vault_token_exposure
    title: "HashiCorp Vault Token Exposure"
    severity: critical
    description: >
      Detects HashiCorp Vault root tokens or service tokens in MCP server
      configuration. Vault tokens provide access to the secrets management
      infrastructure itself, potentially exposing all secrets stored in
      the vault.
    risk_explanation: >
      A compromised Vault token, especially a root token, grants access to
      all secrets stored in the vault. This is a cascading compromise because
      Vault typically stores all other credentials (database passwords, API
      keys, encryption keys). Root tokens have unrestricted access and can
      modify policies, create new tokens, and access any secret path.
    remediation: >
      Never store Vault tokens in configuration files. Use Vault agent
      auto-auth or Kubernetes auth methods for automatic token acquisition.
      Revoke root tokens after initial setup. Use periodic tokens with TTL
      limits. Implement response wrapping for token distribution. Audit
      Vault token usage and revoke unused tokens.
    references:
      - "https://owasp.org/www-project-mcp-top-10/"
      - "https://developer.hashicorp.com/vault/docs/concepts/tokens"
    owasp_mcp:
      - "MCP01:2025"
    tags:
      - credential_exposure
      - vault
      - secrets_manager
      - root_token
