check_id: ssrf009
title: IP Address Representation Bypass
category: ssrf_and_network
severity: high
description: >
  Detects MCP server tools that fail to normalize IP address
  representations before validation. Attackers can bypass IP-based
  blocklists by using alternative representations such as octal
  (0177.0.0.1), hexadecimal (0x7f000001), decimal (2130706433), or
  IPv6-mapped IPv4 addresses (::ffff:127.0.0.1) to encode blocked
  addresses.
risk_explanation: >
  IP address representation bypasses allow attackers to circumvent SSRF
  protections that only check for standard dotted-decimal notation. By
  encoding 127.0.0.1 as 0x7f000001 or 2130706433, an attacker can pass
  URL validation while still reaching localhost. This technique is
  widely used in real-world SSRF exploits against MCP-like systems and
  can reach any address on the blocked IP list.
remediation: >
  Normalize all IP addresses to a canonical form before validation.
  Parse octal, hexadecimal, decimal, and mixed-format IP representations
  into standard binary form before comparing against blocklists. Handle
  IPv6-mapped IPv4 addresses and IPv6 loopback addresses. Use a well-
  tested IP parsing library rather than custom parsing logic. Validate
  the normalized IP against both IPv4 and IPv6 blocklists.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP05:2025"
tags:
  - ssrf
  - network_security
