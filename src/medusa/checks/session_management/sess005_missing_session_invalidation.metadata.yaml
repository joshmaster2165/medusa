check_id: sess005
title: Missing Session Invalidation on Logout
category: session_management
severity: medium
description: >
  Detects MCP servers that fail to properly invalidate sessions when a
  user or LLM client disconnects or logs out. Without explicit session
  invalidation, session tokens remain valid on the server side even
  after the client believes the session has ended, creating a window for
  session reuse attacks.
risk_explanation: >
  If MCP sessions are not invalidated upon logout, an attacker who has
  captured a session token can continue to use it for tool invocations
  even after the legitimate user has disconnected. This is particularly
  dangerous in shared environments or when session tokens are leaked
  through logs, as the tokens remain permanently usable.
remediation: >
  Implement server-side session invalidation that destroys all session
  state upon logout or disconnection. Remove the session from the
  server-side session store immediately. Ensure all associated tokens,
  including refresh tokens and access tokens tied to the session, are
  revoked. Return an error for any subsequent requests using the
  invalidated session ID.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - session_management
  - authentication
