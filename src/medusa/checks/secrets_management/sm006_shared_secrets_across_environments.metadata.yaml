check_id: sm006
title: Shared Secrets Across Environments
category: secrets_management
severity: high
description: >
  Detects MCP server deployments that use the same secrets across
  multiple environments such as development, staging, and production.
  Shared secrets mean that a compromise in a less-secure environment
  directly compromises production.
risk_explanation: >
  When secrets are shared across environments, the security of
  production is only as strong as the weakest environment. Development
  environments typically have relaxed security controls, more people
  with access, and less monitoring. A secret compromised in development
  immediately grants production access. Staging environments that mirror
  production with the same secrets create an unmonitored backdoor to
  production data.
remediation: >
  Generate unique secrets for each environment. Never copy secrets
  between environments. Implement environment-specific secret stores
  with separate access controls. Use naming conventions that make
  environment-specific secrets distinguishable. Automate secret
  provisioning per environment during deployment. Audit for shared
  secrets across environments regularly.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - secrets_management
  - credentials
