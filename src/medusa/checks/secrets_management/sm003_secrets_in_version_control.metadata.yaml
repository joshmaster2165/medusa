check_id: sm003
title: Secrets in Version Control
category: secrets_management
severity: critical
description: >
  Detects MCP server repositories that contain secrets committed to
  version control history. Even if secrets are removed from current
  files, they persist in the git history and can be extracted by anyone
  with repository access.
risk_explanation: >
  Secrets committed to version control are permanently recorded in the
  repository history and are accessible to all current and future
  repository users. Even after secrets are removed from the working
  tree, they remain in commit history indefinitely. Repositories cloned,
  forked, or backed up carry the secrets with them. Public repositories
  expose secrets to the entire internet.
remediation: >
  Implement pre-commit hooks that scan for secrets and block commits
  containing them. Use tools such as git-secrets, trufflehog, or
  gitleaks in CI/CD pipelines. Remove any secrets currently in the
  repository history using git filter-branch or BFG Repo Cleaner, and
  rotate all affected secrets immediately. Add comprehensive patterns to
  .gitignore for files that may contain secrets.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - secrets_management
  - credentials
