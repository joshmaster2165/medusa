check_id: sm010
title: Missing Secret Encryption at Rest
category: secrets_management
severity: high
description: >
  Detects MCP servers that store secrets without encrypting them at
  rest. Unencrypted secret storage means that physical access to the
  storage medium, database dumps, or backup files directly exposes all
  stored secrets in plaintext.
risk_explanation: >
  Secrets stored without encryption at rest are exposed through any
  mechanism that provides access to the raw storage. This includes
  database dumps, file system backups, disk imaging, stolen hardware,
  and compromised storage services. Without encryption at rest, the
  confidentiality of secrets depends entirely on access controls to the
  storage layer, which may be bypassed through physical access or
  infrastructure compromise.
remediation: >
  Encrypt all secrets at rest using strong encryption algorithms such as
  AES-256-GCM. Use envelope encryption where data encryption keys are
  themselves encrypted by key encryption keys stored separately.
  Implement proper key management for the encryption keys with hardware
  security module backing where possible. Verify encryption through
  regular audits that confirm no plaintext secrets exist in storage.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - secrets_management
  - credentials
