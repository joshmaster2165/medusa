check_id: sm008
title: Insecure Secret Generation
category: secrets_management
severity: high
description: >
  Detects MCP servers that generate secrets using weak random number
  generators, predictable algorithms, or insufficient entropy sources.
  Weakly generated secrets can be predicted or brute-forced by attackers
  who understand the generation algorithm.
risk_explanation: >
  Secrets generated with insufficient entropy or predictable algorithms
  can be reproduced by an attacker. Standard random number generators
  such as Math.random() or time-based seeds produce predictable
  sequences that can be computed. Short secrets generated with weak
  randomness can be brute-forced in minutes. An attacker who determines
  the secret generation algorithm can predict past and future secrets.
remediation: >
  Use cryptographically secure random number generators for all secret
  generation, such as os.urandom in Python, crypto.randomBytes in
  Node.js, or /dev/urandom on Linux. Generate secrets with sufficient
  length and entropy, a minimum of 256 bits for cryptographic keys and
  128 bits for tokens. Validate that the entropy source is properly
  seeded. Use well-tested secret generation libraries rather than custom
  implementations.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - secrets_management
  - credentials
