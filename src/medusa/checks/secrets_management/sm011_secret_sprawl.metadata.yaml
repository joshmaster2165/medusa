check_id: sm011
title: Secret Sprawl
category: secrets_management
severity: medium
description: >
  Detects MCP server deployments where the same secret is duplicated
  across multiple locations such as configuration files, environment
  variables, scripts, and documentation. Secret sprawl makes it
  impossible to effectively rotate or revoke secrets because copies
  persist in unknown locations.
risk_explanation: >
  Secret sprawl means that rotating or revoking a secret does not
  actually remove all copies. Duplicated secrets in backup files,
  deployment scripts, documentation, and multiple configuration
  locations persist long after the primary copy is rotated. Each copy is
  an additional exposure point that can be independently discovered and
  exploited. The organization loses track of where secrets exist, making
  comprehensive rotation impossible.
remediation: >
  Centralize all secrets in a single secrets management service with
  references from consuming systems rather than copies. Implement secret
  scanning across the entire codebase, configuration, and documentation
  to identify all copies. Eliminate duplicate copies by replacing them
  with references to the central store. Monitor for new secret copies
  being created outside the central store.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - secrets_management
  - credentials
