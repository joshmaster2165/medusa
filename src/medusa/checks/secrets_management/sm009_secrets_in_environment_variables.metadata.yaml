check_id: sm009
title: Secrets in Environment Variables
category: secrets_management
severity: medium
description: >
  Detects MCP servers that rely solely on environment variables for
  secret storage without additional protection. While better than
  hardcoding, environment variables are accessible to all processes
  running as the same user and are often logged or exposed through
  process listings and debug endpoints.
risk_explanation: >
  Environment variables containing secrets are visible through
  /proc/self/environ on Linux, process inspection tools, debug
  endpoints, crash dumps, and child process inheritance. Any tool or
  library running in the same process has full access to all environment
  variables. Container orchestration platforms often log environment
  variables during deployment, and error reporting services may capture
  them in crash reports.
remediation: >
  Use a secrets management service instead of environment variables for
  sensitive credentials. If environment variables must be used, minimize
  exposure by reading secrets at startup and clearing the environment
  variables. Prevent child process inheritance of secret environment
  variables. Ensure error reporting and logging exclude environment
  variable contents. Consider file-based secret injection as a more
  secure alternative.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - secrets_management
  - credentials
