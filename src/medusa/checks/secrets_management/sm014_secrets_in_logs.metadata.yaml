check_id: sm014
title: Secrets in Log Output
category: secrets_management
severity: high
description: >
  Detects MCP servers that include secrets in log output, whether in
  application logs, access logs, error logs, or debug logs. Logged
  secrets are exposed to anyone with log access and persist in log
  storage systems indefinitely.
risk_explanation: >
  Secrets in logs are exposed to log aggregation systems, SIEM
  platforms, monitoring dashboards, and anyone with log file access.
  Logs are often retained for extended periods and stored with less
  security than credential stores. Log data may be shipped to third-
  party services, shared during debugging, or included in support
  requests. A secret logged once persists across all log backups and
  replicas.
remediation: >
  Implement log sanitization that detects and masks secrets before they
  are written to log output. Use structured logging with explicit field
  marking for sensitive values. Never log authentication tokens, API
  keys, passwords, or encryption keys. Audit existing logs for secret
  exposure and purge any discovered instances. Implement automated log
  scanning for secret patterns.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - secrets_management
  - credentials
