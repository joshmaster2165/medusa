check_id: cred010
title: SMTP Credential Exposure
category: credential_exposure
severity: high
description: >
  Detects email server credentials (SMTP username, password, API keys)
  in MCP server configuration. SMTP credentials allow sending emails as
  the configured sender, enabling phishing and spam campaigns through
  the organization's mail infrastructure.
risk_explanation: >
  Exposed SMTP credentials allow an attacker to send emails through the
  organization's mail servers, bypassing SPF, DKIM, and DMARC
  protections. The attacker can send phishing emails that appear to
  originate from the organization's domain, damaging reputation and
  enabling social engineering attacks against employees and customers.
remediation: >
  Store SMTP credentials in a secrets manager. Use environment variable
  references in configuration. Implement IP-based restrictions on SMTP
  authentication. Use dedicated service accounts with minimal
  permissions for transactional email. Monitor SMTP sending patterns for
  anomalies.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - credential_exposure
  - smtp
  - email
  - mail_credentials
