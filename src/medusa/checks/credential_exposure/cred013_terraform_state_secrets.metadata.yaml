check_id: cred013
title: Terraform State Secrets
category: credential_exposure
severity: critical
description: >
  Detects secrets leaked through Terraform state files referenced in MCP
  server configuration. Terraform state files contain plaintext values
  of all managed resources, including database passwords, API keys, and
  private keys.
risk_explanation: >
  Terraform state files store the complete state of managed
  infrastructure in plaintext JSON, including all resource attributes.
  Database passwords, encryption keys, and API tokens in state files are
  stored unencrypted. Access to a state file grants visibility into the
  entire infrastructure, including credential values that were intended
  to be secret.
remediation: >
  Store Terraform state in encrypted remote backends (S3 with
  encryption, Terraform Cloud). Enable state encryption at rest. Use
  sensitive variables and mark outputs as sensitive. Restrict state file
  access using IAM policies. Never reference Terraform state files
  directly in MCP configuration.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - credential_exposure
  - terraform
  - state_file
  - infrastructure_secrets
