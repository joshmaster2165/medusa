check_id: cred003
title: Secrets in Tool Definitions
category: credential_exposure
severity: high
description: >
  Scans MCP tool descriptions, resource descriptions, resource URIs, and
  prompt definitions for embedded secrets such as API keys, tokens, passwords,
  and private key material. Secrets accidentally included in definitions are
  visible to every client that connects to the server and may be forwarded
  to language models.
risk_explanation: >
  Tool and resource definitions are broadcast to all connected MCP clients
  and often included in LLM context windows. Secrets embedded in these
  definitions are exposed to every user and every model that interacts with
  the server. LLMs may also inadvertently include these secrets in their
  responses, leaking credentials to end users or logging systems.
remediation: >
  Remove all hardcoded secrets from tool descriptions, resource descriptions,
  resource URIs, and prompt definitions. Use server-side environment variables
  or a secrets manager to provide credentials at runtime. Implement automated
  scanning of MCP definitions as part of the CI/CD pipeline to catch
  accidental secret inclusion before deployment.
references:
  - https://modelcontextprotocol.io/specification/2025-03-26/server/tools
  - https://modelcontextprotocol.io/specification/2025-03-26/server/resources
  - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
owasp_mcp:
  - "MCP01:2025"
tags:
  - credential_exposure
  - secrets
  - tool_definitions
  - resource_definitions
