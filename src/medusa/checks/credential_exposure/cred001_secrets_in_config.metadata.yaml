check_id: cred001
title: Secrets in MCP Configuration Files
category: credential_exposure
severity: critical
description: >
  Scans MCP configuration files for hardcoded secrets such as API keys,
  access tokens, private keys, and passwords. Configuration files (e.g.
  claude_desktop_config.json, mcp.json) often contain environment variable
  blocks and command-line arguments where developers accidentally embed
  plaintext credentials.
risk_explanation: >
  Hardcoded secrets in configuration files are easily extracted by anyone
  with read access to the file, including malicious MCP servers, backup
  systems, version control, and log aggregators. Leaked credentials grant
  unauthorized access to third-party services, databases, and cloud
  infrastructure. Because config files are rarely rotated, exposed secrets
  may remain valid indefinitely.
remediation: >
  Never hardcode secrets in MCP configuration files. Use environment variable
  references (e.g. ${ENV_VAR}) or a dedicated secrets manager. Store
  configuration files with restrictive file permissions (600). Add config
  files containing secrets to .gitignore to prevent version control exposure.
  Rotate any credentials that have been committed to configuration files.
references:
  - https://modelcontextprotocol.io/specification/2025-03-26/basic/transports
  - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
owasp_mcp:
  - "MCP01:2025"
tags:
  - credential_exposure
  - secrets
  - configuration
  - hardcoded_credentials
