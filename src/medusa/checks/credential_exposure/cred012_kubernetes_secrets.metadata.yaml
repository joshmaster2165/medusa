check_id: cred012
title: Kubernetes Secret Exposure
category: credential_exposure
severity: critical
description: >
  Detects Kubernetes secrets, service account tokens, or kubeconfig
  credentials in MCP server configuration. Kubernetes credentials grant
  access to cluster resources, pods, and potentially the underlying
  infrastructure.
risk_explanation: >
  Kubernetes service account tokens and kubeconfig credentials grant
  cluster access with the permissions of the associated role. An
  attacker can use these credentials to deploy malicious containers,
  access secrets stored in the cluster, escalate privileges through RBAC
  misconfigurations, or pivot to the underlying node infrastructure.
remediation: >
  Never embed Kubernetes credentials in MCP configuration. Use service
  account token mounting with minimal RBAC permissions. Implement short-
  lived token authentication via TokenRequest API. Store kubeconfig
  files securely with restrictive file permissions. Use workload
  identity for cross-service authentication.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP01:2025"
tags:
  - credential_exposure
  - kubernetes
  - service_account
  - cluster_access
