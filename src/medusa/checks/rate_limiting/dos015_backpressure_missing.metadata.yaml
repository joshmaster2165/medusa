check_id: dos015
title: Missing Backpressure Mechanism
category: rate_limiting
severity: medium
description: >
  Detects MCP server configurations that lack backpressure mechanisms
  for managing flow control between the LLM client and the server.
  Without backpressure, a fast producer can overwhelm a slow consumer,
  causing buffer overflows, memory exhaustion, and dropped messages.
risk_explanation: >
  Missing backpressure in MCP server communications allows one side of
  the connection to overwhelm the other. If an LLM agent sends tool
  invocations faster than the server can process them, unbounded request
  queues grow until memory is exhausted. Conversely, if the server
  generates output faster than the client can consume it, response
  buffers overflow. In both cases, the lack of flow control leads to
  resource exhaustion, data loss, and potential server crashes.
remediation: >
  Implement backpressure mechanisms in the MCP transport layer that
  signal the sender to slow down when the receiver is overwhelmed. Use
  bounded queues with configurable sizes for request processing.
  Implement flow control at the WebSocket or HTTP/2 stream level. Return
  appropriate signals (HTTP 429, WebSocket flow control) when processing
  capacity is exceeded. Monitor queue depths and processing latency to
  detect backpressure conditions. Implement graceful degradation that
  prioritizes in-progress requests over new ones.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP07:2025"
tags:
  - rate_limiting
  - dos
  - availability
