check_id: mt006
title: Shared Credential Store
category: multi_tenant
severity: high
description: >
  Detects MCP servers that store credentials for multiple tenants in a
  shared credential store without proper encryption and access controls
  per tenant. A shared credential store creates a single point of
  compromise that exposes all tenant credentials.
risk_explanation: >
  A shared credential store means that a breach affecting one tenant
  credentials exposes the credentials of all tenants. If the store lacks
  per-tenant encryption, a database compromise reveals all tenant
  secrets simultaneously. Shared storage also creates the risk of
  credential cross-contamination where one tenant operation accidentally
  uses another tenant credentials.
remediation: >
  Implement per-tenant encryption for stored credentials using tenant-
  specific encryption keys. Use a secrets management service that
  enforces tenant-scoped access controls. Isolate credential storage per
  tenant using separate encryption contexts or storage partitions.
  Implement access controls that prevent any single credential retrieval
  operation from accessing multiple tenant credentials.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP09:2025"
tags:
  - multi_tenant
  - isolation
  - data_protection
