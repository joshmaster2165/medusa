check_id: agent003
title: Agent Loop Detection
category: agentic_behavior
severity: medium
description: >
  Detects MCP configurations that lack detection and prevention
  mechanisms for infinite tool invocation loops. Without loop detection,
  an LLM agent can repeatedly invoke the same tool or cycle through a
  set of tools indefinitely, consuming resources and potentially causing
  unintended side effects.
risk_explanation: >
  Agent loops occur when the LLM enters a cycle of tool invocations
  where the output of one tool triggers another, which eventually
  triggers the first tool again. These loops can consume API quotas,
  exhaust server resources, generate excessive costs, and produce
  unintended side effects through repeated tool executions. Loops may
  also indicate prompt injection attacks designed to maximize resource
  consumption or repeated data exfiltration.
remediation: >
  Implement loop detection that identifies repeated patterns in tool
  invocation sequences. Set a maximum number of tool invocations per
  conversation turn and per session. Track tool invocation history and
  detect cycles in the invocation graph. Implement a circuit breaker
  that halts execution when loop patterns are detected. Alert the user
  when potential loops are identified and require manual intervention to
  continue.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP07:2025"
tags:
  - agentic
  - autonomous
  - safety
