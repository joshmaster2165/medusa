check_id: agent020
title: Missing Agent Audit Trail
category: agentic_behavior
severity: medium
description: >
  Detects MCP configurations that lack comprehensive audit logging of
  agent decisions, tool selections, invocation parameters, and outcomes.
  Without audit trails, it is impossible to investigate security
  incidents, detect anomalous behavior, or demonstrate compliance with
  security policies.
risk_explanation: >
  Missing agent audit trails prevent organizations from detecting,
  investigating, and responding to security incidents in MCP agentic
  systems. Without logs of agent decisions and tool invocations, a
  compromised agent can operate undetected for extended periods. Post-
  incident forensics cannot determine what data was accessed, what
  actions were taken, or how the compromise occurred. This also prevents
  compliance with regulations that require detailed audit records of
  automated decision-making.
remediation: >
  Implement comprehensive audit logging that records all agent decisions
  including tool selections, invocation parameters, tool outputs, and
  decision rationale. Log the full context available to the agent at
  each decision point. Store audit logs in a tamper-resistant,
  centralized log store with appropriate retention periods. Implement
  real-time monitoring and alerting on suspicious patterns in agent
  audit logs. Ensure logs contain sufficient detail for forensic
  reconstruction of agent sessions.
references:
  - "https://owasp.org/www-project-mcp-top-10/"
owasp_mcp:
  - "MCP07:2025"
tags:
  - agentic
  - autonomous
  - safety
